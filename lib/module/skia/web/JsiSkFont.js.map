{"version":3,"sources":["JsiSkFont.ts"],"names":["HostObject","ckEnum","JsiSkPaint","JsiSkPoint","JsiSkRect","JsiSkTypeface","JsiSkFont","constructor","CanvasKit","ref","getTextWidth","text","paint","ids","getGlyphIDs","widths","getGlyphWidths","reduce","a","b","getMetrics","result","ascent","descent","leading","bounds","undefined","str","numCodePoints","glyphs","fromValue","getGlyphIntercepts","positions","top","bottom","map","p","Array","from","flat","getScaleX","getSize","getSkewX","isEmbolden","getTypeface","tf","setEdging","edging","setEmbeddedBitmaps","embeddedBitmaps","setHinting","hinting","setLinearMetrics","linearMetrics","setScaleX","sx","setSize","points","setSkewX","setEmbolden","embolden","setSubpixel","subpixel","setTypeface","face"],"mappings":"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","sourcesContent":["import type { CanvasKit, Font } from \"canvaskit-wasm\";\n\nimport type {\n  FontEdging,\n  FontHinting,\n  SkFont,\n  SkPaint,\n  SkPoint,\n  SkTypeface,\n} from \"../types\";\n\nimport { HostObject, ckEnum } from \"./Host\";\nimport { JsiSkPaint } from \"./JsiSkPaint\";\nimport { JsiSkPoint } from \"./JsiSkPoint\";\nimport { JsiSkRect } from \"./JsiSkRect\";\nimport { JsiSkTypeface } from \"./JsiSkTypeface\";\n\nexport class JsiSkFont extends HostObject<Font, \"Font\"> implements SkFont {\n  constructor(CanvasKit: CanvasKit, ref: Font) {\n    super(CanvasKit, ref, \"Font\");\n  }\n\n  getTextWidth(text: string, paint?: SkPaint | undefined) {\n    const ids = this.getGlyphIDs(text);\n    const widths = this.getGlyphWidths(ids, paint);\n    return widths.reduce((a, b) => a + b, 0);\n  }\n\n  getMetrics() {\n    const result = this.ref.getMetrics();\n    return {\n      ascent: result.ascent,\n      descent: result.descent,\n      leading: result.leading,\n      bounds: result.bounds\n        ? new JsiSkRect(this.CanvasKit, result.bounds)\n        : undefined,\n    };\n  }\n\n  getGlyphIDs(str: string, numCodePoints?: number) {\n    // TODO: Fix return value in the C++ implementation\n    return [...this.ref.getGlyphIDs(str, numCodePoints)];\n  }\n\n  // TODO: Fix return value in the C++ implementation, it return float32\n  getGlyphWidths(glyphs: number[], paint?: SkPaint | null) {\n    return [\n      ...this.ref.getGlyphWidths(\n        glyphs,\n        paint ? JsiSkPaint.fromValue(paint) : null\n      ),\n    ];\n  }\n\n  getGlyphIntercepts(\n    glyphs: number[],\n    positions: SkPoint[],\n    top: number,\n    bottom: number\n  ) {\n    return [\n      ...this.ref.getGlyphIntercepts(\n        glyphs,\n        positions.map((p) => Array.from(JsiSkPoint.fromValue(p))).flat(),\n        top,\n        bottom\n      ),\n    ];\n  }\n\n  getScaleX() {\n    return this.ref.getScaleX();\n  }\n\n  getSize() {\n    return this.ref.getSize();\n  }\n\n  getSkewX() {\n    return this.ref.getSkewX();\n  }\n\n  isEmbolden() {\n    return this.ref.isEmbolden();\n  }\n\n  getTypeface() {\n    const tf = this.ref.getTypeface();\n    return tf ? new JsiSkTypeface(this.CanvasKit, tf) : null;\n  }\n\n  setEdging(edging: FontEdging) {\n    this.ref.setEdging(ckEnum(edging));\n  }\n\n  setEmbeddedBitmaps(embeddedBitmaps: boolean) {\n    this.ref.setEmbeddedBitmaps(embeddedBitmaps);\n  }\n\n  setHinting(hinting: FontHinting) {\n    this.ref.setHinting(ckEnum(hinting));\n  }\n\n  setLinearMetrics(linearMetrics: boolean) {\n    this.ref.setLinearMetrics(linearMetrics);\n  }\n\n  setScaleX(sx: number) {\n    this.ref.setScaleX(sx);\n  }\n\n  setSize(points: number) {\n    this.ref.setSize(points);\n  }\n\n  setSkewX(sx: number) {\n    this.ref.setSkewX(sx);\n  }\n\n  setEmbolden(embolden: boolean) {\n    this.ref.setEmbolden(embolden);\n  }\n\n  setSubpixel(subpixel: boolean) {\n    this.ref.setSubpixel(subpixel);\n  }\n\n  setTypeface(face: SkTypeface | null) {\n    this.ref.setTypeface(face ? JsiSkTypeface.fromValue(face) : null);\n  }\n}\n"]}